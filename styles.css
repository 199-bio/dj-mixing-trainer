:root{
  /* Colors */
  --bg:#0c0d10; --panel:#14161a; --accent:#3fc1c9; --text:#e6e8ee; --muted:#98a0ad; --good:#43d17b; --warn:#ffb54a; --danger:#ff5d5d;
  /* Type scale */
  --fs-0: clamp(12px, 0.8vw, 13px);
  --fs-1: clamp(13px, 0.9vw, 14px);
  --fs-2: clamp(14px, 1.1vw, 16px);
  --fs-3: clamp(16px, 1.4vw, 18px);
  /* Spacing (8pt grid) */
  --space-2: 2px; --space-4: 4px; --space-6: 6px; --space-8: 8px; --space-12: 12px; --space-16: 16px; --space-20: 20px; --space-24: 24px; --space-32: 32px; --space-40: 40px; --space-48: 48px; --space-64: 64px; --space-96: 96px;
  /* Targets (WCAG 2.2: 24x24) */
  --target-min: 24px;
}
*{ box-sizing:border-box }
html,body{ height:100% }
body{ margin:0; font-family:Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif; background:var(--bg); color:var(--text); font-size:var(--fs-2) }
.topbar{ display:flex; align-items:center; justify-content:space-between; padding:10px 16px; background:var(--panel); border-bottom:1px solid #1d2026 }
.topbar h1{ margin:0; font-size:18px }
.topbar .actions button{ margin-left:8px }
button{ background:#22262d; color:var(--text); border:1px solid #2a2f38; border-radius:6px; padding:8px 10px; cursor:pointer }
button:hover{ background:#2a2f38 }
input[type="range"], input[type="number"], input[type="text"]{ width:100% }
label{ font-size:12px; color:var(--muted); display:flex; flex-direction:column; gap:6px }
.layout{ display:grid; grid-template-columns: 1fr 340px 1fr; gap:var(--space-16); padding:var(--space-16) }
.deck{ background:var(--panel); padding:var(--space-12); border:1px solid #1d2026; border-radius:10px; display:flex; flex-direction:column; gap:var(--space-10,10px); position:relative; container-type:inline-size; container-name:deck }
.deck h2{ margin:2px 0 4px; font-size:16px }
.row{ display:flex; gap:10px; align-items:center; flex-wrap:wrap }
.row.file{ display:none }
.file .track-name{ flex:1; color:var(--muted); overflow:hidden; text-overflow:ellipsis; white-space:nowrap }
.transport button, .loop button, .hotcues button{ flex:1 }
.loop button.active{ background:var(--accent); color:#081317; border-color:var(--accent) }
.tempo .tempo-readout{ width:80px; display:inline-block; color:var(--muted); text-align:right }
.eq label, .gain label{ flex:1 }
.filter label{ width:100% }
.hotcues{ display:grid; grid-template-columns: repeat(4, 1fr); gap:8px; width:100% }
.hotcue{ display:flex; gap:6px }
.cue-toggle{ display:flex; align-items:center; gap:6px }
.xfader, .master{ background:var(--panel); border:1px solid #1d2026; border-radius:10px; padding:var(--space-12); margin-bottom:var(--space-12) }
.master h3{ margin:8px 0 }
.meter{ width:100%; height:10px; background:#0b0d11; border:1px solid #1d2026; border-radius:6px; overflow:hidden }
.meter .bar{ height:100%; width:2%; background:linear-gradient(90deg, var(--good), var(--warn)); transition:width .06s linear }
.master-meter .bar{ background:linear-gradient(90deg, var(--good), var(--warn), var(--danger)) }
.beat-indicator{ display:flex; gap:6px; margin-left:auto }
.beat-dot{ width:10px; height:10px; border-radius:50%; background:#292d34; opacity:.6 }
.beat-dot.active{ background:var(--accent); opacity:1 }
.center{ display:flex; flex-direction:column; gap:12px; align-items:stretch; justify-content:flex-start }
.help{ position:fixed; inset:0; background:rgba(0,0,0,.6); display:flex; align-items:center; justify-content:center }
.help.hidden{ display:none }
.help-inner{ background:#0f1116; padding:20px; border-radius:12px; border:1px solid #1d2026; width:min(720px, 94vw) }
.actions button, .help-inner button{ background:var(--accent); color:#081317; border:none }
.actions button:hover, .help-inner button:hover{ filter:brightness(0.95) }
.harmonic{ color:var(--muted); font-size:12px; margin-top:6px }
@media (max-width: 1000px){ .layout{ grid-template-columns: 1fr; } .center{ order:3 } }

/* Container queries: deck scales gracefully */
@container deck (min-width: 520px){
  .skin-svg{ max-width: 520px; margin-inline:auto }
}
@container deck (max-width: 400px){
  .skin-svg{ max-width: 360px }
}

/* Active deck focus ring */
.deck[data-active="true"]{ outline:2px solid var(--accent); outline-offset:2px }

/* Minimum pointer target size */
.skin .button, .skin .pad, .skin .knob, .skin .fader .thumb, button, input[type="range"]{ min-width:var(--target-min); min-height:var(--target-min) }
.skin .button, .skin .pad, .skin .knob, .skin .fader .thumb{ cursor:pointer }

/* Tutorial (coachmarks) */
.coach.hidden{ display:none }
.coach{ position:fixed; inset:0; pointer-events:auto; z-index:9999; }
.coach-dim{ position:absolute; inset:0; background:transparent; pointer-events:auto }
.coach-spotlight{ position:absolute; width:120px; height:60px; border-radius:10px; box-shadow:0 0 0 9999px rgba(0,0,0,.55), 0 0 0 2px var(--accent); transition:all .2s ease; }
.coach-card{ position:absolute; max-width:min(420px, 92vw); background:#0f1116; border:1px solid #1d2026; border-radius:12px; padding:14px; color:var(--text); box-shadow:0 10px 30px rgba(0,0,0,.4); pointer-events:auto }
.coach-title{ font-weight:600; margin-bottom:6px }
.coach-body{ color:var(--muted); font-size:14px; line-height:1.4; margin-bottom:10px }
.coach-ctrls{ display:flex; align-items:center; gap:8px; justify-content:space-between }
.coach-ctrls button{ background:var(--accent); color:#081317; border:none; padding:8px 10px; border-radius:8px }
.coach-ctrls .coach-prev{ background:#272c34; color:var(--text) }
.coach-ctrls .coach-skip{ background:#272c34; color:var(--text) }
.coach-progress{ color:var(--muted); font-size:12px }

/* Pulsing highlight helper */
.pulse{ position:relative; }
.pulse::after{ content:""; position:absolute; inset:-6px; border-radius:10px; border:2px solid var(--accent); animation:pulse 1.4s ease-out infinite; pointer-events:none }
@keyframes pulse{ 0%{ opacity:1; transform:scale(.98) } 80%{ opacity:0; transform:scale(1.08) } 100%{ opacity:0 } }

/* Visual (non-interactive) skin */
.visual .row, .visual .xfader, .visual .master { display:none }
.visual .skin{ display:block }
.skin{ pointer-events:auto }
.visual .skin{ pointer-events:none }
.skin-svg{ width:100%; height:auto; display:block }
.skin .label{ fill:var(--muted); font-size:10px; text-anchor:middle }
.btn-face{ fill:url(#btnGrad, none); filter: drop-shadow(0 1px 2px rgba(0,0,0,.5)); stroke:#2a2f38; stroke-width:1 }
.button.square .btn-face{ fill:#1b1e24 }
.knob-face{ fill:#1c2027; stroke:#2a2f38; stroke-width:1; filter: drop-shadow(0 1px 2px rgba(0,0,0,.5)) }
.knob-pointer{ stroke:#e6e8ee; stroke-width:2; stroke-linecap:round }
.led-ring{ fill:none; stroke-width:3; opacity:.25 }
.led-frame{ fill:none; stroke-width:2; opacity:.25 }
.led-on{ opacity:1 }
.led-green{ stroke:#43d17b }
.led-blue{ stroke:#3fc1c9 }
.led-orange{ stroke:#ffb54a }
.led-amber{ stroke:#ffc266 }
.led-cyan{ stroke:#3de1ff }
.pad-face{ fill:#1a1d22; stroke:#2a2f38; stroke-width:1 }
.fader .track{ fill:#0b0d11; stroke:#2a2f38; stroke-width:1 }
.fader .thumb{ fill:#2a2f38; stroke:#3b414d; stroke-width:1 }
.meter-bg{ fill:#0b0d11; stroke:#1d2026; stroke-width:1 }
.meter-fill{ fill:linear-gradient(90deg, var(--good), var(--warn), var(--danger)); }
.beat-dot{ fill:#2a2f38 }
.beat-dot.active{ fill:var(--accent) }
